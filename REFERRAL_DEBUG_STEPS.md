# üîç –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

## –¢–µ–∫—É—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–∫–æ–º–º–∏—Ç –±—É–¥–µ—Ç —Å–µ–π—á–∞—Å):
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –ú–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –≤–µ—Å—å –ø—É—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞

## –®–∞–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools –≤ –±—Ä–∞—É–∑–µ—Ä–µ
–ù–∞–∂–º–∏—Ç–µ `F12` ‚Üí –≤–∫–ª–∞–¥–∫–∞ `Console`

### 2. –ü–æ–ª—É—á–∏—Ç–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
2. `/dashboard/bonuses` ‚Üí —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É
3. –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–∏–¥–∞: `https://margofitness.pro/auth?ref=abc12345`

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –≤ –ò–ù–ö–û–ì–ù–ò–¢–û
**–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤–æ–µ –æ–∫–Ω–æ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ (`Ctrl+Shift+N`)

### 4. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ Console (—à–∞–≥ –∑–∞ —à–∞–≥–æ–º):

#### –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /auth:
```
[Auth] URL params: { redirect: '/dashboard', refCode: 'abc12345', fullURL: '...' }
[Auth] Validating referral code: abc12345
[Auth] Validation result: { success: true, data: { userName: '...' } }
```

‚úÖ **–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ** - ref –∫–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω –∏–∑ URL

‚ùå **–ï—Å–ª–∏ `refCode: 'NOT_FOUND'`** - –ø—Ä–æ–±–ª–µ–º–∞ —Å URL, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å—Å—ã–ª–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç `?ref=...`

#### –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ email/–ø–∞—Ä–æ–ª—è):
```
[Auth] Saving referral code to localStorage: abc12345
[Auth] Saved. Verify: abc12345
```

‚úÖ **–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ** - –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage

‚ùå **–ï—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—Ç–µ** - –ø—Ä–æ–±–ª–µ–º–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º, –≤–æ–∑–º–æ–∂–Ω–æ –±—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç localStorage

#### –ü–æ—Å–ª–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –Ω–∞ /dashboard:
```
[Referral Processor] Component mounted
[Referral Processor] Checking localStorage: { refCode: 'abc12345', allKeys: [...] }
[Referral Processor] ‚úÖ Found pending referral code: abc12345
[Referral Processor] Waiting 2 seconds for session...
[Referral Processor] Sending request to API...
[Referral Processor] API response status: 200
[Referral Processor] API response data: { success: true }
[Referral Processor] ‚úÖ Referral processed successfully
```

‚úÖ **–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –≤–µ—Å—å —ç—Ç–æ—Ç —Ñ–ª–æ—É** - —Ä–µ—Ñ–µ—Ä–∞–ª –æ–±—Ä–∞–±–æ—Ç–∞–ª—Å—è —É—Å–ø–µ—à–Ω–æ

‚ùå **–ï—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å —Ä–∞–Ω—å—à–µ** - —Å–º–æ—Ç—Ä–∏—Ç–µ –≥–¥–µ –∏–º–µ–Ω–Ω–æ:

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

#### `refCode: 'NOT_FOUND'` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ /auth
**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `ref`
**–†–µ—à–µ–Ω–∏–µ:** 
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Å—ã–ª–∫—É
- –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `?ref=–∫–æ–¥` –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å `&ref=–∫–æ–¥`

#### `No referral code to save`
**–ü—Ä–æ–±–ª–µ–º–∞:** refCode –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
**–†–µ—à–µ–Ω–∏–µ:** 
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ URL –µ—Å—Ç—å `ref` –ø–∞—Ä–∞–º–µ—Ç—Ä
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É /auth —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–æ–π

#### `No pending referral code found` –≤ dashboard
**–ü—Ä–æ–±–ª–µ–º–∞:** localStorage –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª –∫–æ–¥ –∏–ª–∏ –±—ã–ª –æ—á–∏—â–µ–Ω
**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ DevTools ‚Üí Application ‚Üí Local Storage
2. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–ª—é—á `pending_referral_code`
3. –ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —à–∞–≥–∏

#### `API response status: 400` –∏–ª–∏ `401`
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ `API response data` - —Ç–∞–º –±—É–¥–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Vercel

#### `API response status: 500`
**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Vercel logs
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `SUPABASE_SERVICE_ROLE_KEY` –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

1. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:** "üéâ –ë–æ–Ω—É—Å +250 —à–∞–≥–æ–≤ –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—é!"
2. **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**
3. **–ë–∞–ª–∞–Ω—Å:** 500 —à–∞–≥–æ–≤ (250 welcome + 250 referral)
4. **–ò—Å—Ç–æ—Ä–∏—è:** 2 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ `/dashboard/bonuses`

### 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ Supabase

1. Database ‚Üí `referrals` —Ç–∞–±–ª–∏—Ü–∞
2. –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å —Å –≤–∞—à–∏–º `referred_id`
3. Database ‚Üí `bonus_transactions` —Ç–∞–±–ª–∏—Ü–∞
4. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 2 –∑–∞–ø–∏—Å–∏:
   - `type: 'welcome'` amount: 250
   - `type: 'referral_bonus'` amount: 250

## –ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã "–±–∞–ª–∞–Ω—Å 250":

### 1. –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω
- –°—Å—ã–ª–∫–∞ –±–µ–∑ `?ref=...`
- –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –Ω–µ–ø–æ–ª–Ω–∞—è —Å—Å—ã–ª–∫–∞

### 2. localStorage –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
- –†–µ–∂–∏–º –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç localStorage –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±—ã—á–Ω–æ–µ –æ–∫–Ω–æ —Å –≤—ã—Ö–æ–¥–æ–º –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞

### 3. –¢–∞–π–º–∞—É—Ç —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π
- –°–µ—Å—Å–∏—è –Ω–µ —É—Å–ø–µ–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∑–∞ 2 —Å–µ–∫—É–Ω–¥—ã
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç

### 4. SERVICE_ROLE_KEY –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Vercel Environment Variables
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞

### 5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª –¥–≤–∞–∂–¥—ã
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π email

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ –∏–∑ Console –∏ –ø—Ä–∏—à–ª–∏—Ç–µ:
- –ì–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Ñ–ª–æ—É?
- –ö–∞–∫–∏–µ –æ—à–∏–±–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç?
- –ß—Ç–æ –≤ API response data?

–¢–æ–≥–¥–∞ —Å–º–æ–≥—É —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É!

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –∏ –ø—Ä–æ–π–¥–∏—Ç–µ –ø–æ —à–∞–≥–∞–º –≤—ã—à–µ ‚òùÔ∏è

