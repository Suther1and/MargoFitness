# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ - –°–≤–æ–¥–∫–∞

**–î–∞—Ç–∞:** 25 –¥–µ–∫–∞–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

---

## üêõ –ü—Ä–æ–±–ª–µ–º—ã –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. ‚ùå **Google OAuth** –ø–µ—Ä–µ–∫–∏–¥—ã–≤–∞–ª –Ω–∞ localhost –≤–º–µ—Å—Ç–æ production
2. ‚ùå **–Ø–Ω–¥–µ–∫—Å OAuth** –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É "invalid_scope"
3. ‚ö†Ô∏è **Telegram OAuth** –Ω–µ –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–ª —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. Google OAuth
**–§–∞–π–ª:** `components/oauth-buttons.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `NEXT_PUBLIC_SITE_URL` –≤–º–µ—Å—Ç–æ `window.location.origin`
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage –ø–µ—Ä–µ–¥ OAuth —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
‚úÖ Google OAuth —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ production –¥–æ–º–µ–Ω  
‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å Google OAuth

### 2. –Ø–Ω–¥–µ–∫—Å OAuth
**–§–∞–π–ª:** `app/api/auth/yandex/init/route.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:**
- –£–±—Ä–∞–Ω –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π scope `login:email login:info login:avatar`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ scope

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
‚úÖ –Ø–Ω–¥–µ–∫—Å OAuth –±–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É "invalid_scope"  
‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –Ø–Ω–¥–µ–∫—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 3. Telegram OAuth
**–§–∞–π–ª:** –ò–∑–º–µ–Ω–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

**–°—Ç–∞—Ç—É—Å:**
‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage  
‚úÖ API –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥  
‚úÖ –ë–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù –ù–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω—ã 3 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

### 1. `docs/OAUTH_FIX_GUIDE.md`
**–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ** –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ OAuth –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Google OAuth
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –Ø–Ω–¥–µ–∫—Å OAuth
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è Telegram OAuth
- –†–∞–∑–¥–µ–ª Troubleshooting
- Checklist –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 2. `docs/OAUTH_QUICK_FIX.md`
**–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ** –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã:
- Google localhost redirect (2 –º–∏–Ω—É—Ç—ã)
- –Ø–Ω–¥–µ–∫—Å invalid_scope (2 –º–∏–Ω—É—Ç—ã)
- Telegram —Ä–µ—Ñ–µ—Ä–∞–ª (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏)
- –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 3. `docs/OAUTH_SETUP.md` (–æ–±–Ω–æ–≤–ª–µ–Ω)
–û–±–Ω–æ–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã" —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

---

## üîß –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|--------|-----------|
| `components/oauth-buttons.tsx` | 19-43 | –î–æ–±–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ NEXT_PUBLIC_SITE_URL |
| `app/api/auth/yandex/init/route.ts` | 37-47 | –£–±—Ä–∞–Ω scope, –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ |
| `app/auth/callback/route.ts` | 1-23 | –û–±–Ω–æ–≤–ª–µ–Ω –ª–æ–≥ (–∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–æ–µ) |

---

## ‚öôÔ∏è –¢—Ä–µ–±—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ `.env.local` –∏ Vercel:

```env
# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è OAuth!
NEXT_PUBLIC_SITE_URL=https://yourdomain.com

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key

# Google OAuth (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ Supabase Dashboard)
# Client ID –∏ Secret –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ Supabase, –Ω–µ –≤ .env

# –Ø–Ω–¥–µ–∫—Å OAuth
YANDEX_CLIENT_ID=your_client_id
YANDEX_CLIENT_SECRET=your_client_secret

# Telegram OAuth
TELEGRAM_BOT_TOKEN=your_bot_token
NEXT_PUBLIC_TELEGRAM_BOT_NAME=your_bot_username
NEXT_PUBLIC_TELEGRAM_BOT_ID=your_bot_id
```

### Google Cloud Console

**Authorized redirect URIs:**
```
https://YOUR_PROJECT.supabase.co/auth/v1/callback
```

‚ùó **–ù–ï –¥–æ–±–∞–≤–ª—è–π—Ç–µ** `https://yourdomain.com/auth/callback`

### Supabase Dashboard

**Authentication ‚Üí URL Configuration:**
- **Site URL:** `https://yourdomain.com`
- **Redirect URLs:** `https://yourdomain.com/**`

**Authentication ‚Üí Providers ‚Üí Google:**
- –í–∫–ª—é—á–µ–Ω: ‚úÖ
- Client ID: –∏–∑ Google Console
- Client Secret: –∏–∑ Google Console

### –Ø–Ω–¥–µ–∫—Å OAuth Console

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
- **Callback URI:** `https://yourdomain.com/api/auth/yandex/callback`
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:** –ù–ï –≤—ã–±—Ä–∞–Ω—ã (–±–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### Telegram Bot

**–ß–µ—Ä–µ–∑ @BotFather:**
```
/setdomain
‚Üí –í—ã–±—Ä–∞—Ç—å –±–æ—Ç–∞
‚Üí yourdomain.com (–ë–ï–ó https://)
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

#### 1. Google OAuth
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://yourdomain.com/auth
2. –ù–∞–∂–º–∏—Ç–µ "Google"
3. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å
4. –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å –Ω–∞ https://yourdomain.com/dashboard
5. ‚úÖ –ù–ï –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∫–∏–¥—ã–≤–∞—Ç—å –Ω–∞ localhost!
```

#### 2. –Ø–Ω–¥–µ–∫—Å OAuth
```
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://yourdomain.com/auth
2. –ù–∞–∂–º–∏—Ç–µ "Yandex"
3. –î–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è –Ø–Ω–¥–µ–∫—Å OAuth
4. ‚úÖ –ù–ï –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "invalid_scope"
5. –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–µ—Ä–Ω–µ—Ç –Ω–∞ dashboard
```

#### 3. Telegram + –†–µ—Ñ–µ—Ä–∞–ª
```
1. –í–æ–π–¥–∏—Ç–µ –≤ Dashboard ‚Üí –ë–æ–Ω—É—Å—ã
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É
3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –Ω–æ–≤–æ–º –±—Ä–∞—É–∑–µ—Ä–µ (–∏–Ω–∫–æ–≥–Ω–∏—Ç–æ)
4. –ù–∞–∂–º–∏—Ç–µ "Telegram"
5. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ Telegram
6. ‚úÖ –î–æ–ª–∂–Ω–æ –Ω–∞—á–∏—Å–ª–∏—Ç—å—Å—è 500 —à–∞–≥–æ–≤ (250 + 250 –∑–∞ —Ä–µ—Ñ–µ—Ä–∞–ª)
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ü—Ä–æ–≤–∞–π–¥–µ—Ä | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|-----------|----------------|-------------------|
| Google OAuth | ‚ùå –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ localhost | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| –Ø–Ω–¥–µ–∫—Å OAuth | ‚ùå invalid_scope | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| Telegram OAuth | ‚ö†Ô∏è –†–µ—Ñ–µ—Ä–∞–ª –Ω–µ –≤—Å–µ–≥–¥–∞ | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ | ‚ö†Ô∏è –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å OAuth | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ |

---

## üöÄ –î–µ–ø–ª–æ–π

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] `NEXT_PUBLIC_SITE_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Vercel Environment Variables
- [ ] –í—Å–µ OAuth –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ callback URLs
- [ ] Supabase Site URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ production –¥–æ–º–µ–Ω
- [ ] Google Authorized redirect URIs: `https://PROJECT.supabase.co/auth/v1/callback`
- [ ] –Ø–Ω–¥–µ–∫—Å Callback URI: `https://yourdomain.com/api/auth/yandex/callback`
- [ ] Telegram Bot domain: `yourdomain.com` (—á–µ—Ä–µ–∑ `/setdomain`)

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ 3 –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Supabase Dashboard
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ:** `docs/OAUTH_FIX_GUIDE.md`
- **–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** `docs/OAUTH_QUICK_FIX.md`
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OAuth:** `docs/OAUTH_SETUP.md`
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:** `ENV_TEMPLATE.md`

---

## ‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ü–æ–º–∏–º–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º, –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã:

1. **localStorage –¥–ª—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤** - —Ç–µ–ø–µ—Ä—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ OAuth —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º
2. **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
3. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ** - –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è NEXT_PUBLIC_SITE_URL
4. **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - 3 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–∞ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:** ‚úÖ –î–∞  
**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** ‚úÖ –ü–æ–ª–Ω–∞—è  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞ production

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 25 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0.0

