# ⚠️ СТАНДАРТ ОПТИМИЗАЦИИ МОБИЛЬНЫХ ИНТЕРФЕЙСОВ (V1.0)
> **ВАЖНО:** Данный документ определяет архитектурные правила работы с анимациями в проекте. **ЗАПРЕЩЕНО УДАЛЯТЬ** при рефакторинге. Любой новый UI-компонент должен соответствовать этим критериям производительности.

---

## 1. Паттерн: Раскрывающийся список (Expandable Pattern)

Применяется к любым компонентам, меняющим свою высоту (аккордеоны, выпадающие меню, списки выбора).

### А. Принцип "Static Content"
**Проблема:** Мерцание и "желе" при вложенности анимаций.
*   **ПРАВИЛО:** Внутри анимируемого по высоте (`height: auto`) родителя **запрещено** использовать любые `layout` пропсы Framer Motion для дочерних элементов.
*   **РЕАЛИЗАЦИЯ:** Дети должны быть обычными статичными узлами (`div`, `span`). Анимация состояния (например, смена цвета при клике) должна выполняться только через CSS (`transition-colors`).

### Б. Стратегия асимметричного тайминга
**Проблема:** Ощущение "залипания" интерфейса при закрытии.
*   **ПРАВИЛО:** Вход и выход должны иметь разные кривые.
    *   **Вход (Entry):** Spring (жесткость ~300) или `easeOut`. Плавное раздвижение пространства.
    *   **Выход (Exit):** Всегда `tween/linear` ускорение (например, `easeIn` или `[0.4, 0, 1, 1]`). Быстрое схлопывание без инерции.

---

## 2. Паттерн: Взаимодействие в потоке (Layout Flow)

Правила для элементов, которые сдвигаются (выталкиваются) другими анимируемыми блоками.

### А. Исключение конфликтующих переходов
*   **ПРАВИЛО:** Элементы, находящиеся в общем потоке (siblings), **не должны** иметь свойство `transition: all`.
*   **ПОЧЕМУ:** При сдвиге родителем браузер пытается запустить собственную CSS-анимацию на каждое изменение координат, что множит нагрузку на CPU в геометрической прогрессии.
*   **РЕАЛИЗАЦИЯ:** Заменять на специфичные свойства: `transition: color, opacity, background-color`.

### Б. Изоляция отрисовки (Containment)
*   **ПРАВИЛО:** Каждому крупному блоку (карточке, секции) необходимо свойство `contain: paint layout`. 
*   **РЕЗУЛЬТАТ:** Браузер ограничивает область перерисовки пикселей только границами этого блока.

---

## 3. Технические оптимизации GPU (Performance God Mode)

### А. Режим "Is Animating" (Stripping)
Во время активного движения макета (Reflow) необходимо временно упрощать графику.
*   **АЛГОРИТМ:**
    1. Навешивать класс `.is-animating` на `body` или корневой контейнер.
    2. Через CSS отключать самые "дорогие" свойства:
       ```css
       .is-animating * {
         box-shadow: none !important;
         text-shadow: none !important;
         backdrop-filter: none !important;
         filter: none !important;
       }
       ```

### Б. Принудительное создание слоев (Promotion)
*   **ПРАВИЛО:** Крупные блоки должны быть вынесены на GPU заранее, чтобы не было задержки (jank) в момент старта анимации.
*   **РЕАЛИЗАЦИЯ:**
    ```css
    .ui-block {
      transform: translateZ(0);
      will-change: transform;
      backface-visibility: hidden;
    }
    ```

### В. Адаптивная прозрачность
*   **ПРАВИЛО:** На мобильных устройствах (< 768px) использовать `backdrop-blur` запрещено. Заменять на непрозрачный фон (opacity > 0.95). Блюр оставлять только для десктопов через `md:`.

---

## 4. Чек-лист для ИИ / Разработчика

При создании или оптимизации страницы проверьте:
1. [ ] Все ли дочерние элементы анимированного родителя являются статичными (без `layout`)?
2. [ ] Отсутствует ли `transition: all` у элементов, которые могут двигаться?
3. [ ] Внедрен ли механизм отключения теней/фильтров во время анимации (`isAnimating`)?
4. [ ] Добавлены ли GPU-подсказки (`translateZ`, `will-change`) для движущихся блоков?
5. [ ] Заблокированы ли взаимодействия (`pointer-events: none`) на время сдвига?
