# üéâ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `phone` –∏ `profile_completed_at`
2. **Storage bucket** - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–æ–≤
3. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤–∞—Ç–∞—Ä–∞** - –∫—Ä–∞—Å–∏–≤—ã–π –∫—Ä—É–≥–ª—ã–π –∞–≤–∞—Ç–∞—Ä —Å –∑–∞–≥–ª—É—à–∫–æ–π (–∏–Ω–∏—Ü–∏–∞–ª—ã)
4. **–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ** - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (–∏–º—è, –ø–æ—á—Ç–∞, —Ç–µ–ª–µ—Ñ–æ–Ω, –∞–≤–∞—Ç–∞—Ä)
5. **Dashboard –æ–±–Ω–æ–≤–ª–µ–Ω** - –∫—Ä–∞—Å–∏–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏
6. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∫–∞–∑** - –º–æ–¥–∞–ª–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ

## üìã –®–∞–≥–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–í Supabase Dashboard (SQL Editor) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –§–∞–π–ª: database/migrations/006_ADD_PHONE_AND_PROFILE_COMPLETION.sql
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤–µ—Å—å –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ `database/migrations/006_ADD_PHONE_AND_PROFILE_COMPLETION.sql`

### 2. –°–æ–∑–¥–∞–π—Ç–µ Storage Bucket –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤

#### –í Supabase Dashboard:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage** ‚Üí **Create a new bucket**
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Name**: `avatars`
   - **Public bucket**: ‚úÖ –í–∫–ª—é—á–∏—Ç—å
   - **File size limit**: 5MB
   - **Allowed MIME types**: `image/jpeg`, `image/png`, `image/webp`

3. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è bucket, –≤ SQL Editor –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ RLS:

```sql
-- –ü–æ–ª–∏—Ç–∏–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∞–≤–∞—Ç–∞—Ä—ã
CREATE POLICY "Users can upload their own avatar"
ON storage.objects FOR INSERT
TO authenticated
WITH CHECK (
  bucket_id = 'avatars' 
  AND auth.uid()::text = (storage.foldername(name))[1]
);

-- –ü–æ–ª–∏—Ç–∏–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∞–≤–∞—Ç–∞—Ä—ã
CREATE POLICY "Users can update their own avatar"
ON storage.objects FOR UPDATE
TO authenticated
USING (
  bucket_id = 'avatars' 
  AND auth.uid()::text = (storage.foldername(name))[1]
);

-- –ü–æ–ª–∏—Ç–∏–∫–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∞–≤–∞—Ç–∞—Ä—ã
CREATE POLICY "Users can delete their own avatar"
ON storage.objects FOR DELETE
TO authenticated
USING (
  bucket_id = 'avatars' 
  AND auth.uid()::text = (storage.foldername(name))[1]
);

-- –ü–æ–ª–∏—Ç–∏–∫–∞: –í—Å–µ –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∞–≤–∞—Ç–∞—Ä—ã
CREATE POLICY "Anyone can view avatars"
ON storage.objects FOR SELECT
TO public
USING (bucket_id = 'avatars');
```

### 3. –ì–æ—Ç–æ–≤–æ! üéâ

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω):

```bash
npm run dev
```

## üé® –ß—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å:

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

‚úÖ **–ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
‚úÖ **–ö—Ä–∞—Å–∏–≤–∞—è —Ñ–æ—Ä–º–∞** - —Å –º–∞—Å–∫–æ–π –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (+7 (999) 999-99-99)
‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∞** - drag & drop, preview, –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚úÖ **–ö—Ä—É–≥–ª—ã–π –∞–≤–∞—Ç–∞—Ä** - —Å –∞–≤—Ç–æ–æ–±—Ä–µ–∑–∫–æ–π –∏ –∑–∞–≥–ª—É—à–∫–æ–π (–∏–Ω–∏—Ü–∏–∞–ª—ã –Ω–∞ —Ü–≤–µ—Ç–Ω–æ–º —Ñ–æ–Ω–µ)
‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π dashboard** - –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è —Å –ø–æ—á—Ç–æ–π –∏ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º
‚úÖ **–ö–Ω–æ–ø–∫–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"** - –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
‚úÖ **–ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"** - –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ
‚úÖ **–ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –∏–∑ OAuth –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
‚úÖ **–£–¥–∞–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞** - –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∑–∞–≥–ª—É—à–∫–µ

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ (—Ç–æ–ª—å–∫–æ JPG, PNG, WEBP)
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (–º–∞–∫—Å–∏–º—É–º 5MB)
‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏–º–∏ –∞–≤–∞—Ç–∞—Ä–∞–º–∏
‚úÖ Server-side –≤–∞–ª–∏–¥–∞—Ü–∏—è

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

1. **–ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥** - –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
2. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ** - —É–∫–∞–∂–∏—Ç–µ –∏–º—è, –ø–æ—á—Ç—É, —Ç–µ–ª–µ—Ñ–æ–Ω (–≤—Å–µ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
3. **–ê–≤–∞—Ç–∞—Ä** - –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞–º–µ—Ä—É, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ, –∑–∞–≥—Ä—É–∑–∏—Ç–µ
4. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è –Ω–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ:

```tsx
// –ê–≤–∞—Ç–∞—Ä
import { UserAvatar } from '@/components/user-avatar'

<UserAvatar
  avatarUrl={profile.avatar_url}
  fullName={profile.full_name}
  email={profile.email}
  size="lg"
/>

// –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
import { ProfileEditDialog } from '@/components/profile-edit-dialog'

<ProfileEditDialog
  open={open}
  onOpenChange={setOpen}
  profile={profile}
  isFirstTime={false}
/>
```

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `components/user-avatar.tsx` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤–∞—Ç–∞—Ä–∞
- `components/profile-edit-dialog.tsx` - –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `app/dashboard/profile-edit-wrapper.tsx` - –æ–±–µ—Ä—Ç–∫–∞ —Å –ª–æ–≥–∏–∫–æ–π –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞
- `lib/actions/user-profile.ts` - server actions –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è
- `database/migrations/006_ADD_PHONE_AND_PROFILE_COMPLETION.sql` - –º–∏–≥—Ä–∞—Ü–∏—è –ë–î

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `app/dashboard/page.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω header —Å –∫–∞—Ä—Ç–æ—á–∫–æ–π –ø—Ä–æ—Ñ–∏–ª—è
- `types/supabase.ts` - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ç–∏–ø—ã –¥–ª—è phone –∏ profile_completed_at

## üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ OAuth (Google)
2. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã—Ç—å—Å—è –º–æ–¥–∞–ª–∫–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –∏ –ø–æ—á—Ç—ã –∏–∑ Google
4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–∞–∑–º–µ—Ä–∞ –∏ —Ç–∏–ø–∞)
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∞—Å–∫—É)
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
7. –ù–∞–∂–º–∏—Ç–µ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" - –º–æ–¥–∞–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å–Ω–æ–≤–∞
8. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–≤–∞—Ç–∞—Ä

---

**–ì–æ—Ç–æ–≤–æ! –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! üöÄ**

